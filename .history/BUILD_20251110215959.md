# Building FLAC2AIFF.app

This guide explains how to build a distributable macOS `.app` bundle.

## Prerequisites

1. **Python 3.8+** installed
2. **ffmpeg** binary (see setup instructions below)
3. **PyInstaller** for packaging

## Step 1: Install Dependencies

```bash
pip install -r requirements.txt
pip install pyinstaller
```

## Step 2: Set Up FFmpeg

The app needs an ffmpeg binary bundled. Run the setup script:

```bash
./setup_ffmpeg.sh
```

This will:
- Look for system ffmpeg (if installed via Homebrew)
- Copy it to `resources/ffmpeg/ffmpeg`
- Make it executable

If the script doesn't find ffmpeg, you can:
1. Install via Homebrew: `brew install ffmpeg`
2. Download a static build from https://evermeet.cx/ffmpeg/
3. Manually copy the binary to `resources/ffmpeg/ffmpeg` and make it executable:
   ```bash
   chmod +x resources/ffmpeg/ffmpeg
   ```

## Step 3: Build the App

```bash
pyinstaller FLAC2AIFF.spec
```

This will create:
- `build/` - Temporary build files
- `dist/FLAC2AIFF.app` - The final app bundle

## Step 4: Test the App

1. Open `dist/FLAC2AIFF.app` in Finder
2. Right-click and select "Open" (to bypass Gatekeeper on first launch)
3. Test with a sample FLAC file

## Step 5: Distribute

The `dist/FLAC2AIFF.app` bundle is self-contained and can be:
- Copied to `/Applications`
- Distributed to other users
- Zipped for distribution

**Note**: Users may need to right-click and "Open" on first launch to bypass macOS Gatekeeper warnings.

## Troubleshooting

### "ffmpeg not found" error

- Ensure `resources/ffmpeg/ffmpeg` exists and is executable
- Check that PyInstaller included it in the bundle (check `dist/FLAC2AIFF.app/Contents/MacOS/`)
- Try rebuilding with `--clean` flag: `pyinstaller --clean FLAC2AIFF.spec`

### App won't launch

- Check Console.app for crash logs
- Try running from terminal: `open -a dist/FLAC2AIFF.app`
- Verify Python version: `python --version` (should be 3.8+)

### Large app size

The app bundle includes:
- Python runtime (~50-100 MB)
- All dependencies (~10-20 MB)
- ffmpeg binary (~50-100 MB)

Total size is typically 100-200 MB, which is normal for a bundled Python app.

